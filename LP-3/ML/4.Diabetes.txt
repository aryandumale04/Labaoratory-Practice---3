#prerequisites
import pandas as pd
import numpy as np
import seaborn as sns
print(sns.get_dataset_names())


dataset=sns.load_dataset("titanic")
df =pd.DataFrame(dataset)
df.head()

df = df[["survived","pclass","sex","age","fare"]]
df.dropna(inplace=True)


df
Q1= df["fare"].quantile(0.25)
Q3=df["fare"].quantile(0.75)
IQR=Q3-Q1
lower= Q1 -1.5*IQR
upper=Q3+1.5*IQR
outliers=df[(df["fare"] < lower) | (df["fare"] > upper)]
outliers
df=df[(df["fare"] >= lower) & (df["fare"] <= upper)]
df


from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import LabelEncoder, StandardScaler
from sklearn.metrics import accuracy_score,confusion_matrix,recall_score,precision_score,f1_score


labelEncoder = LabelEncoder()
df["sex"]=labelEncoder.fit_transform(df["sex"])
df["sex"]
x=df[["pclass","fare","age","sex"]]
y=df["survived"]
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)
scaler=StandardScaler()
x_train=scaler.fit_transform(x_train)
x_test=scaler.transform(x_test)


knn= KNeighborsClassifier(n_neighbors=7)
knn.fit(x_train,y_train)
y_pred=knn.predict(x_test)

print("Accuracy of KNN model : ",accuracy_score(y_test,y_pred))
print("Precision of KNN model : ",precision_score(y_test,y_pred))
print("Recall of KNN model : ",recall_score(y_test,y_pred))
print("F1-score of KNN model : ",f1_score(y_test,y_pred))
print("Confusion  of KNN model : \n",confusion_matrix(y_test,y_pred))

from sklearn.ensemble import RandomForestClassifier
rdF = RandomForestClassifier(n_estimators=100,random_state=42)
rdF.fit(x_train,y_train)


y_rdF_pred=rdF.predict(x_test)

from sklearn.metrics import mean_squared_error,r2_score
print("RMSE of RDF model : ",np.sqrt(mean_squared_error(y_test,y_rdF_pred)))
print("R2 score of RDF model : ",r2_score(y_test,y_rdF_pred))

from sklearn.metrics import roc_auc_score 

# Predicted probabilities for positive class (1)
y_KNN_proba = knn.predict_proba(x_test)[:, 1]
y_RDF_proba = rdF.predict_proba(x_test)[:, 1]

# ROC–AUC Scores
roc_auc_KNN = roc_auc_score(y_test, y_KNN_proba)
roc_auc_RDF = roc_auc_score(y_test, y_RDF_proba)

print("ROC–AUC Score (KNN):", roc_auc_KNN)
print("ROC–AUC Score (Random Forest):", roc_auc_RDF)