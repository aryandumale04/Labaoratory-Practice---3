#prerequisites
import pandas as pd
import numpy as np
import seaborn as sns
import warnings
warnings.filterwarnings("ignore")
print(sns.get_dataset_names())
data = sns.load_dataset("titanic")
df=pd.DataFrame(data)
df

df=df[["survived","pclass","sex","age","fare"]]
df.dropna(inplace=True)
df




#divide the dataset 
x=df.drop("survived",axis=1)
y=df["survived"]

#endcoding 
from sklearn.preprocessing import LabelEncoder


labelEncoder = LabelEncoder()
x["sex"] = labelEncoder.fit_transform(x["sex"])


#split the data and then notrmalise it 
from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=42)

from sklearn.preprocessing import StandardScaler 
scaler = StandardScaler()
x_train=scaler.fit_transform(x_train)
x_test=scaler.transform(x_test)


#build the neural network

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense,Dropout
model = Sequential()
model.add(Dense(units=6, activation="relu", input_dim=x_train.shape[1]))
model.add(Dropout(0.3))
model.add(Dense(units=6, activation="relu"))
model.add(Dense(units=1,activation="sigmoid"))
model.compile(optimizer="adam", loss="binary_crossentropy", metrics=["accuracy"] )


history=model.fit(x_train,y_train,epochs=20,batch_size=32,validation_data=(x_test,y_test))


print("Accuracy per Epoch : \n")
train_acc=history.history["accuracy"]
val_acc=history.history["val_accuracy"]
for i in range(len(train_acc)):
    print(f"Epoch {i+1} -> Training Accuracy : {train_acc[i]*100:.2f}% , Validation Accuracy : {val_acc[i]*100:.2f}%")
import matplotlib.pyplot as plt
plt.plot(history.history["accuracy"],label="Training Accuracy")
plt.plot(history.history["val_accuracy"],label="Validation Accuracy")
plt.title("Accuracy per Epoch")
plt.xlabel="Epoch"
plt.ylabel="Accuracy"
plt.legend()
plt.show()

y_pred=model.predict(x_test)
y_pred = (y_pred > 0.5)

#evaluation 
from sklearn.metrics import accuracy_score,confusion_matrix
print("Accuracy Score : ",accuracy_score(y_test,y_pred))
print("Confusion Matrix : ")
print(confusion_matrix(y_test,y_pred))

